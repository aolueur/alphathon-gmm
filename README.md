# GMM Model and Strategy Implementation for Alphathon 2024

- Team name: Big Red Big Purple
- Elina (Fuwei) Zhuang: fz266@cornell.edu
- Hudson Chen: hc884@cornell.edu
- Shun Wang: sw2337@cornell.edu
- Joshua (Yuanzhi) Ma: ym533@cornell.edu
- Yuao Peng: yp439@cornell.edu
- Wanqing Li: w.li@nyu.edu

Problem worked on: Using Large Language Models (LLMs) in Investment

A title for the solution/strategy: 2-D Bayesian Regime Switch

---
- [GMM Model and Strategy Implementation for Alphathon 2024](#gmm-model-and-strategy-implementation-for-alphathon-2024)
  - [Reproduction Guide](#reproduction-guide)
  - [GMM Model](#gmm-model)
  - [Sector Ticker Mapping](#sector-ticker-mapping)
  - [A Note on Running `gen_*` Scripts](#a-note-on-running-gen_-scripts)


## Reproduction Guide
To reproduce the results of the project, follow the steps below:
1. Keep the directory structure as it is. Do not delete anything in the `./raw_data` directory. Do not remove `./clean_data/3_market_regimes.txt` and `./clean_data/5_market_regimes.txt`. These two files are generated by the LLM stored in another repository.
2. Make sure all the required packages are installed. The required packages are listed in the `requirements.txt` file. To install the required packages, run the following command:
```
pip install -r requirements.txt
```
3. Run the following command to generate the clean data:
```
python -m gens.gen_data
```
4. Run the following command to run the GMM model:
```
python gmm_run.py
```
5. Run the following command the merge the output of the GMM model with the market regimes offered by the LLM:
```
python data_merge.py
```
6. Run the following command to generate the summary of the GMM model:
```
python -m gens.gen_summary
```
7. Run the following command to generate Markowitz portfolio weights:
```
python -m gens.gen_weights.py 
```
8. Run the following command to generate the strategy returns:
```
python strategy.py
```

The last command will generate `./report.html` which contains the summary of the strategy returns.

## GMM Model

The `GaussianMixtureModel` class is a wrapper around the `sklearn.mixture.GaussianMixture` class. It provides a simple interface to train and predict using a Gaussian Mixture Model.

The `GaussianMixtureModel` constructor takes
- `data`: The training data to be fed into the model. The data should be a 2D numpy array with the shape `(n_samples, n_features)`. The `n_samples` is the number of samples in the dataset and `n_features` is the number of features in each sample.and an optional parameter `n_components` (default None).  
- `n_components` (optional): The number of components in the GMM model. If not specified, the model will choose the optimal number of components using the Bayesian Information Criterion (BIC).
  
The `GaussianMixtureModel` class has the following methods:
- `n_components(self)`: Returns the number of components in the GMM model.
- `predict(self, data)`: Predicts the cluster labels for the given data. The data should be a 2D numpy array with the shape `(n_samples, n_features)`. Returns a 1D numpy array containing the predicted cluster labels.
- `weights(self)`: Returns the weights of the components in the GMM model.
- `means(self)`: Returns the means of the components in the GMM model.
- `covariances(self)`: Returns the covariances of the components in the GMM model.
- `bic(self)`: Returns the Bayesian Information Criterion (BIC) of the GMM model.
- `aic(self)`: Returns the Akaike Information Criterion (AIC) of the GMM model.

## Sector Ticker Mapping
- XLY: Consumer Discretionary
- XLP: Consumer Staples
- XLE: Energy 
- XLF: Financial
- XLV: Health Care
- XLI: Industrial
- XLB: Materials
- XLK: Technology
- XLU: Utilities


## A Note on Running `gen_*` Scripts
THe `gen_*` scripts in the `gens` directory are used to generate data, summary, etc.. To run these scripts, run the following command from the root directory of the project:
```
python -m gens.gen_<script_name>
```

For example, to run the `gen_data.py` script, run the following command:
```
python -m gens.gen_data
```
Notice that you do not need to include the `.py` extension in the command.